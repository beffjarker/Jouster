{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "S3PreviewEnvironmentManagement",
            "Effect": "Allow",
            "Action": [
                "s3:CreateBucket",
                "s3:DeleteBucket",
                "s3:ListBucket",
                "s3:GetBucketLocation",
                "s3:GetBucketWebsite",
                "s3:PutBucketWebsite",
                "s3:DeleteBucketWebsite",
                "s3:PutBucketPolicy",
                "s3:GetBucketPolicy",
                "s3:DeleteBucketPolicy",
                "s3:PutPublicAccessBlock",
                "s3:GetPublicAccessBlock",
                "s3:PutBucketTagging",
                "s3:GetBucketTagging",
                "s3:PutBucketVersioning",
                "s3:GetBucketVersioning"
            ],
            "Resource": [
                "arn:aws:s3:::jouster-preview-pr-*",
                "arn:aws:s3:::jouster-blue-static",
                "arn:aws:s3:::jouster-green-static",
                "arn:aws:s3:::pr*-*.jouster.org",
                "arn:aws:s3:::qa.jouster.org",
                "arn:aws:s3:::stg.jouster.org",
                "arn:aws:s3:::staging.jouster.org"
            ]
        },
        {
            "Sid": "S3ObjectManagement",
            "Effect": "Allow",
            "Action": [
                "s3:PutObject",
                "s3:GetObject",
                "s3:DeleteObject",
                "s3:PutObjectAcl",
                "s3:GetObjectAcl",
                "s3:ListMultipartUploadParts",
                "s3:AbortMultipartUpload",
                "s3:PutObjectVersionAcl",
                "s3:GetObjectVersion",
                "s3:DeleteObjectVersion"
            ],
            "Resource": [
                "arn:aws:s3:::jouster-preview-pr-*/*",
                "arn:aws:s3:::jouster-blue-static/*",
                "arn:aws:s3:::jouster-green-static/*",
                "arn:aws:s3:::pr*-*.jouster.org/*",
                "arn:aws:s3:::qa.jouster.org/*",
                "arn:aws:s3:::stg.jouster.org/*",
                "arn:aws:s3:::staging.jouster.org/*"
            ]
        },
        {
            "Sid": "S3ListAllBuckets",
            "Effect": "Allow",
            "Action": [
                "s3:ListAllMyBuckets",
                "s3:HeadBucket"
            ],
            "Resource": "*"
        },
        {
            "Sid": "Route53PreviewDNSManagement",
            "Effect": "Allow",
            "Action": [
                "route53:ListHostedZones",
                "route53:GetHostedZone",
                "route53:ListResourceRecordSets",
                "route53:ChangeResourceRecordSets",
                "route53:GetChange"
            ],
            "Resource": "*",
            "Condition": {
                "StringLike": {
                    "route53:RecordName": [
                        "*.jouster.org",
                        "jouster.org"
                    ]
                }
            }
        },
        {
            "Sid": "CloudFormationStackManagement",
            "Effect": "Allow",
            "Action": [
                "cloudformation:CreateStack",
                "cloudformation:UpdateStack",
                "cloudformation:DeleteStack",
                "cloudformation:DescribeStacks",
                "cloudformation:DescribeStackEvents",
                "cloudformation:DescribeStackResources",
                "cloudformation:GetTemplate"
            ],
            "Resource": [
                "arn:aws:cloudformation:us-west-2:*:stack/jouster-preview-*/*",
                "arn:aws:cloudformation:us-west-2:*:stack/jouster-qa/*",
                "arn:aws:cloudformation:us-west-2:*:stack/jouster-staging/*"
            ]
        },
        {
            "Sid": "CloudWatchLogsForDeploymentTracking",
            "Effect": "Allow",
            "Action": [
                "logs:CreateLogGroup",
                "logs:CreateLogStream",
                "logs:PutLogEvents",
                "logs:DescribeLogGroups",
                "logs:DescribeLogStreams"
            ],
            "Resource": [
                "arn:aws:logs:us-west-2:*:log-group:/aws/lambda/jouster-*",
                "arn:aws:logs:us-west-2:*:log-group:/aws/apigateway/jouster-*"
            ]
        }
    ]
}

