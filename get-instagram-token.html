<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Instagram Access Token for @beffjarker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        .step {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #0066cc;
            background: #f9f9f9;
        }
        .button {
            background: #0066cc;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 5px;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
        }
        .code-box {
            background: #f5f5f5;
            padding: 15px;
            border: 1px solid #ddd;
            margin: 10px 0;
            word-break: break-all;
            font-family: monospace;
        }
        .input-box {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .success {
            border-left-color: green;
            background: #f0fff0;
        }
        .warning {
            border-left-color: orange;
            background: #fff8e1;
        }
        .extract-button {
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Get Instagram Access Token for @beffjarker</h1>

    <div class="step warning">
        <h3>‚ö†Ô∏è Important: Use @beffjarker Account</h3>
        <p>Make sure you're logged into Instagram as <strong>@beffjarker</strong> before proceeding. If you're logged in as a different account, log out and log back in as @beffjarker.</p>
    </div>

    <div class="step">
        <h3>Step 1: Get Authorization Code</h3>
        <p>Click the button below to authorize your Instagram app to access @beffjarker's posts:</p>
        <a href="https://api.instagram.com/oauth/authorize?client_id=809266451465053&redirect_uri=https://httpbin.org/get&scope=user_profile,user_media&response_type=code"
           class="button" target="_blank">üîê Authorize Instagram Access</a>
        <p><small>This will open a new tab. After authorization, you'll be redirected to a page showing your authorization code.</small></p>
    </div>

    <div class="step">
        <h3>Step 2: Extract Authorization Code</h3>
        <p>After clicking the authorization button above, copy the entire URL from the redirected page and paste it here:</p>
        <input type="text" id="redirect-url" class="input-box" placeholder="Paste the full URL from the redirected page here...">
        <button class="extract-button" onclick="extractCode()">Extract Code</button>
        <div id="code-result"></div>
    </div>

    <div class="step">
        <h3>Step 3: Get Access Token</h3>
        <div id="token-section" style="display: none;">
            <p>Great! Now click the button below to exchange your authorization code for an access token:</p>
            <button class="extract-button" onclick="getAccessToken()" id="token-button">Get Access Token</button>
            <div id="token-result"></div>
        </div>
    </div>

    <div class="step success" id="final-result" style="display: none;">
        <h3>üéâ Success! Your Access Token:</h3>
        <div class="code-box" id="final-token"></div>
        <p><strong>Next step:</strong> Copy this token and update your .env file:</p>
        <div class="code-box">INSTAGRAM_ACCESS_TOKEN=your_token_here</div>
    </div>

    <script>
        let authCode = '';

        function extractCode() {
            const url = document.getElementById('redirect-url').value;
            const codeMatch = url.match(/code=([^&]+)/);

            if (codeMatch) {
                authCode = codeMatch[1];
                document.getElementById('code-result').innerHTML = `
                    <div style="background: #d4edda; padding: 10px; border-radius: 4px; margin: 10px 0;">
                        ‚úÖ Authorization code extracted successfully!<br>
                        <strong>Code:</strong> ${authCode}
                    </div>
                `;
                document.getElementById('token-section').style.display = 'block';
            } else {
                document.getElementById('code-result').innerHTML = `
                    <div style="background: #f8d7da; padding: 10px; border-radius: 4px; margin: 10px 0;">
                        ‚ùå Could not find authorization code in URL. Make sure you copied the entire URL.
                    </div>
                `;
            }
        }

        async function getAccessToken() {
            if (!authCode) {
                alert('Please extract the authorization code first!');
                return;
            }

            document.getElementById('token-button').disabled = true;
            document.getElementById('token-button').textContent = 'Getting token...';

            try {
                const response = await fetch('https://api.instagram.com/oauth/access_token', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        client_id: '809266451465053',
                        client_secret: '4e73f8b81f0d7c3fa7eb39c42c6d39b1',
                        grant_type: 'authorization_code',
                        redirect_uri: 'https://httpbin.org/get',
                        code: authCode
                    })
                });

                const data = await response.json();

                if (data.access_token) {
                    document.getElementById('final-token').textContent = data.access_token;
                    document.getElementById('final-result').style.display = 'block';
                    document.getElementById('token-result').innerHTML = `
                        <div style="background: #d4edda; padding: 10px; border-radius: 4px; margin: 10px 0;">
                            ‚úÖ Access token obtained successfully! Scroll down to see it.
                        </div>
                    `;
                } else {
                    throw new Error(data.error_message || 'Failed to get access token');
                }
            } catch (error) {
                document.getElementById('token-result').innerHTML = `
                    <div style="background: #f8d7da; padding: 10px; border-radius: 4px; margin: 10px 0;">
                        ‚ùå Error: ${error.message}<br>
                        <small>Make sure the authorization code is valid and hasn't expired.</small>
                    </div>
                `;
            }

            document.getElementById('token-button').disabled = false;
            document.getElementById('token-button').textContent = 'Get Access Token';
        }

        // Check if there's a code in the current URL
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            if (code) {
                document.getElementById('redirect-url').value = window.location.href;
                extractCode();
            }
        };
    </script>
</body>
</html>

