<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Token Generator</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: 0 auto; }
        .step { margin: 20px 0; padding: 20px; border: 2px solid #0066cc; border-radius: 8px; background: #f9f9ff; }
        .urgent { border-color: #ff6600; background: #fff9f0; }
        .code-input { width: 100%; min-height: 100px; padding: 15px; font-family: monospace; font-size: 14px; border: 2px solid #ddd; border-radius: 4px; }
        .button { background: #0066cc; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block; margin: 10px 5px; font-weight: bold; }
        .big-button { font-size: 18px; padding: 15px 30px; }
        .success { background: #28a745; }
        .warning { background: #ff6600; }
        h1 { color: #333; text-align: center; }
        h2 { color: #0066cc; }
        .highlight { background: yellow; padding: 2px 4px; }
        .instructions { background: #e8f4f8; padding: 15px; border-left: 4px solid #0066cc; margin: 15px 0; }
    </style>
</head>
<body>
    <h1>üîß Instagram Access Token Generator for @beffjarker</h1>

    <div class="step urgent">
        <h2>‚ö†Ô∏è Important: Get Fresh Authorization Code</h2>
        <p>Since the previous authorization didn't capture the code properly, we need to get a fresh one.</p>

        <div class="instructions">
            <strong>Step 1:</strong> Click this button to start fresh Instagram authorization:
        </div>

        <a href="https://api.instagram.com/oauth/authorize?client_id=809266451465053&redirect_uri=https://httpbin.org/anything&scope=user_profile,user_media&response_type=code&state=beffjarker"
           class="button big-button" target="_blank">
            üîÑ Get Fresh Instagram Authorization
        </a>

        <div class="instructions">
            <strong>What will happen:</strong>
            <ol>
                <li>Instagram will ask you to log in again with @beffjarker</li>
                <li>Click "Authorize" again</li>
                <li>You'll be redirected to a page showing JSON data</li>
                <li>Copy the ENTIRE page content and paste it below</li>
            </ol>
        </div>
    </div>

    <div class="step">
        <h2>üìã Paste the Complete Response Here</h2>
        <p>After clicking authorize, you'll see a page with JSON data. Copy EVERYTHING from that page and paste it here:</p>

        <textarea id="response-data" class="code-input" placeholder="Paste the entire JSON response from the httpbin.org page here...

It should look something like:
{
  &quot;args&quot;: {
    &quot;code&quot;: &quot;AQD1234567890abcdef...&quot;,
    &quot;state&quot;: &quot;beffjarker&quot;
  },
  &quot;data&quot;: &quot;&quot;,
  &quot;files&quot;: {},
  &quot;form&quot;: {},
  &quot;headers&quot;: { ... },
  &quot;json&quot;: null,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;origin&quot;: &quot;...&quot;,
  &quot;url&quot;: &quot;https://httpbin.org/anything?code=AQD...&quot;
}"></textarea>

        <button onclick="extractTokenFromResponse()" class="button success big-button">
            üîç Extract Authorization Code
        </button>

        <div id="extraction-result"></div>
    </div>

    <div id="token-exchange" style="display:none;" class="step">
        <h2>üéØ Ready to Generate Access Token!</h2>
        <p>Authorization code found: <span id="found-code" class="highlight"></span></p>
        <p>Now I'll generate your access token...</p>

        <div id="curl-command-container">
            <h3>Copy this command and run it in your terminal:</h3>
            <textarea id="curl-command" class="code-input" readonly></textarea>
            <button onclick="copyCommand()" class="button">üìã Copy Command</button>
        </div>
    </div>

    <script>
        function extractTokenFromResponse() {
            const responseText = document.getElementById('response-data').value.trim();

            if (!responseText) {
                document.getElementById('extraction-result').innerHTML = `
                    <p style="color: red; font-weight: bold;">‚ö†Ô∏è Please paste the response data first!</p>
                `;
                return;
            }

            try {
                // Try to parse as JSON first
                const response = JSON.parse(responseText);
                let code = null;

                // Look for code in various places
                if (response.args && response.args.code) {
                    code = response.args.code;
                } else if (response.code) {
                    code = response.code;
                } else if (response.url) {
                    // Extract from URL
                    const match = response.url.match(/[?&]code=([^&]+)/);
                    if (match) {
                        code = decodeURIComponent(match[1]);
                    }
                }

                if (code) {
                    document.getElementById('found-code').textContent = code;
                    document.getElementById('extraction-result').innerHTML = `
                        <div style="background: #e8f5e8; padding: 15px; border: 2px solid #28a745; border-radius: 5px; margin: 15px 0;">
                            <h3 style="color: #28a745; margin-top: 0;">‚úÖ Success! Authorization Code Found:</h3>
                            <div style="background: white; padding: 10px; font-family: monospace; word-break: break-all; border: 1px solid #ddd;">
                                ${code}
                            </div>
                        </div>
                    `;

                    // Generate curl command
                    const curlCommand = `curl -X POST "https://api.instagram.com/oauth/access_token" \\
  -F "client_id=809266451465053" \\
  -F "client_secret=4e73f8b81f0d7c3fa7eb39c42c6d39b1" \\
  -F "grant_type=authorization_code" \\
  -F "redirect_uri=https://httpbin.org/anything" \\
  -F "code=${code}"`;

                    document.getElementById('curl-command').value = curlCommand;
                    document.getElementById('token-exchange').style.display = 'block';
                    document.getElementById('token-exchange').scrollIntoView({ behavior: 'smooth' });

                } else {
                    throw new Error('No authorization code found in the response');
                }

            } catch (error) {
                // If JSON parsing fails, try to extract code directly from text
                const codeMatch = responseText.match(/[?&"']code[?"']\s*:\s*[?"']?([^"'&\s,}]+)/i);
                if (codeMatch) {
                    const code = codeMatch[1];
                    document.getElementById('found-code').textContent = code;
                    document.getElementById('extraction-result').innerHTML = `
                        <div style="background: #e8f5e8; padding: 15px; border: 2px solid #28a745; border-radius: 5px; margin: 15px 0;">
                            <h3 style="color: #28a745; margin-top: 0;">‚úÖ Code Extracted from Text:</h3>
                            <div style="background: white; padding: 10px; font-family: monospace; word-break: break-all; border: 1px solid #ddd;">
                                ${code}
                            </div>
                        </div>
                    `;

                    const curlCommand = `curl -X POST "https://api.instagram.com/oauth/access_token" \\
  -F "client_id=809266451465053" \\
  -F "client_secret=4e73f8b81f0d7c3fa7eb39c42c6d39b1" \\
  -F "grant_type=authorization_code" \\
  -F "redirect_uri=https://httpbin.org/anything" \\
  -F "code=${code}"`;

                    document.getElementById('curl-command').value = curlCommand;
                    document.getElementById('token-exchange').style.display = 'block';
                    document.getElementById('token-exchange').scrollIntoView({ behavior: 'smooth' });

                } else {
                    document.getElementById('extraction-result').innerHTML = `
                        <div style="background: #ffe8e8; padding: 15px; border: 2px solid #ff4444; border-radius: 5px; margin: 15px 0;">
                            <h3 style="color: #cc0000; margin-top: 0;">‚ùå Could not find authorization code</h3>
                            <p>Please make sure you:</p>
                            <ol>
                                <li>Clicked the authorization button above</li>
                                <li>Logged in with @beffjarker on Instagram</li>
                                <li>Clicked "Authorize"</li>
                                <li>Copied the ENTIRE page content from httpbin.org</li>
                            </ol>
                            <p><strong>The response should contain "code": followed by a long string of letters and numbers.</strong></p>
                        </div>
                    `;
                }
            }
        }

        function copyCommand() {
            const command = document.getElementById('curl-command');
            command.select();
            command.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(command.value).then(() => {
                alert('‚úÖ Command copied! Now paste and run it in your terminal.');
            });
        }
    </script>
</body>
</html>

